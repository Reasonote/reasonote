---------------------------------------------------------------------------
-- 
-- ⚠️ DO NOT EDIT THIS FILE!
-- THIS FILE WAS AUTOMATICALLY GENERATED FROM THE CONTENTS OF A CLEANLY-MIGRATED DATABASE.
-- 
-- ℹ️ To change the contents of this file, create a new migration under 'supabase/migrations/'
-- that makes the change you would like to see.
-- 
---------------------------------------------------------------------------
-- Function: public.chat_message_context_check

---------------------------------------------------------------------------
-- BEGIN: PG_DUMP RESULT (FUNCTION: public.chat_message_context_check)
------------------------------
CREATE OR REPLACE FUNCTION public.chat_message_context_check()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF NEW._role = 'user' THEN
    IF NEW.context_type IS NOT NULL THEN
      RAISE EXCEPTION 'Cannot set context_type on a message with _role=user';
    END IF;
    IF NEW.context_id IS NOT NULL THEN
      RAISE EXCEPTION 'Cannot set context_id on a message with _role=user';
    END IF;
    IF NEW.context_data IS NOT NULL THEN
      RAISE EXCEPTION 'Cannot set context_data on a message with _role=user';
    END IF;
  END IF;
  RETURN NEW;
END;
$function$



------------------------------
-- END: PG_DUMP RESULT (FUNCTION: public.chat_message_context_check)
---------------------------------------------------------------------------
