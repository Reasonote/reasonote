---------------------------------------------------------------------------
-- 
-- ⚠️ DO NOT EDIT THIS FILE!
-- THIS FILE WAS AUTOMATICALLY GENERATED FROM THE CONTENTS OF A CLEANLY-MIGRATED DATABASE.
-- 
-- ℹ️ To change the contents of this file, create a new migration under 'supabase/migrations/'
-- that makes the change you would like to see.
-- 
---------------------------------------------------------------------------
-- Function: public.set_podcast_line_number

---------------------------------------------------------------------------
-- BEGIN: PG_DUMP RESULT (FUNCTION: public.set_podcast_line_number)
------------------------------
CREATE OR REPLACE FUNCTION public.set_podcast_line_number()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.line_number := (
    -- This allows the number is always unique and sequential. -1 is so that the first line in a podcast is always 0.
    SELECT COALESCE(MAX(line_number), -1) + 1
    FROM public.podcast_line
    WHERE podcast_id = NEW.podcast_id
  );
  RETURN NEW;
END;
$function$



------------------------------
-- END: PG_DUMP RESULT (FUNCTION: public.set_podcast_line_number)
---------------------------------------------------------------------------
